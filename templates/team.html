<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>팀 코드 입력</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-900 text-white flex items-center justify-center min-h-screen px-4">
  <div class="bg-gray-800 p-8 rounded-xl shadow-lg w-full max-w-md">
    <h1 class="text-2xl font-bold mb-6 text-center">팀 코드 설정</h1>

    <!-- 팀 코드 입력 폼 (이제 필수 아님) -->
    <form method="post" action="{{ url_for('set_team_code') }}" class="flex gap-2 mb-4">
        <input type="text" name="team_code" placeholder="(선택) 팀 코드 입력 - 개인은 생략 가능"
        class="border p-3 rounded w-full text-black">
 
        <button type="submit" class="bg-blue-600 hover:bg-blue-700 text-white px-5 py-2 rounded text-base w-24">
            다음
        </button>
          
    </form>

    <!-- 팀 코드 자동 생성 버튼 -->
    <div class="text-center mb-4">
        <button onclick="generateCode()" class="bg-gray-700 text-white px-3 py-1 rounded hover:bg-gray-600 text-sm">
          🔄 코드 생성
        </button>
    </div>

    <!-- ✅ 팀 결과 미리 보기 버튼 -->
    <form method="get" action="" id="previewForm" class="text-center">
      <button type="submit"
              class="text-blue-400 underline hover:text-blue-200 text-sm"
              onclick="event.preventDefault(); goToResult();">
        🔍 현재 팀 결과 미리 보기
      </button>
    </form>
  </div>

  <script>
    function generateCode() {
      fetch("/generate_team_code")
        .then(response => response.json())
        .then(data => {
          document.querySelector('input[name="team_code"]').value = data.code;
        });
    }

    function goToResult() {
      const code = document.querySelector('input[name="team_code"]').value.trim();
      if (code) {
        window.location.href = `/team_result/${code}`;
      } else {
        alert("먼저 팀 코드를 입력하세요.");
      }
    }
  </script>
</body>
</html>
